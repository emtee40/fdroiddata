AntiFeatures:
  NonFreeNet:
    en-US: Depends on the Nym network.
Categories:
  - Connectivity
  - Internet
  - Security
  - System

WebSite: https://nym.com
License: GPL-3.0
SourceCode: https://github.com/nymtech/nym-vpn-client
IssueTracker: https://github.com/nymtech/nym-vpn-client/issues
Changelog: https://github.com/nymtech/nym-vpn-client/releases
Translation: https://weblate.nymte.ch/projects/nymvpn

AutoName: NymVPN

RepoType: git
Repo: https://github.com/nymtech/nym-vpn-client.git

Builds:
  - versionName: v1.1.2
    versionCode: 11200
    commit: ccc66118847b27350cefada4dae737c8ee2280a9
    subdir: nym-vpn-android
    sudo:
      - apt-get update && sudo apt-get install -y libdbus-1-dev libmnl-dev libnftnl-dev protobuf-compiler git curl gcc g++ make unzip
    init: bash scripts/fdroid-prebuild.sh
    ndk: r25c
    gradle:
      - fdroid
    scanignore:
      - nym-vpn-android/nym-vpn-client/src/main/jniLibs/
    rm:
      - nym-vpn-apple
      - nym-vpn-app
      - proto
    prebuild:
      - echo "Building WireGuard dep"
      - echo "Working dir: $PWD"
      - export GOROOT="$HOME/go"
      - export PATH="$PATH:$GOROOT/bin"
      - source "$HOME/.cargo/env"
      - archDir=$(basename $1/toolchains/llvm/prebuilt/*/)
      - echo "archdir: ${archDir}"
      - echo "NDK path: $ANDROID_NDK_HOME"
      - export NDK_TOOLCHAIN_DIR="$ANDROID_NDK_HOME/toolchains/llvm/prebuilt/${archDir}/bin"
      - bash $PWD/../wireguard/build-wireguard-go.sh
      - bash $PWD/../wireguard/libwg/build-android.sh
      - export RUSTFLAGS="-L ${PWD}/../build/lib/aarch64-linux-android -L ${PWD}/../build/lib/x86_64-unknown-linux-gnu"
      - (cd $PWD/../nym-vpn-core/crates/nym-vpn-lib; cargo ndk -t arm64-v8a -o ../../../nym-vpn-android/nym-vpn-client/src/main/jniLibs build --release)
      - (cd $PWD/../nym-vpn-core; cargo run --bin uniffi-bindgen generate --library ./target/aarch64-linux-android/release/libnym_vpn_lib.so  --language kotlin --out-dir ../nym-vpn-android/nym-vpn-client/src/main/java/net/nymtech/vpn -n)
      - cargo license -j --avoid-dev-deps --current-dir ../nym-vpn-core/crates/nym-vpn-lib --filter-platform aarch64-linux-android --avoid-build-deps > ./nym-vpn-client/src/main/assets/licenses_rust.json
      - mv $PWD/nym-vpn-client/src/main/jniLibs/arm64-v8a/libnym_vpn_lib.so $PWD/nym-vpn-client/src/main/jniLibs/arm64-v8a/libnym_vpn_lib.so
      - mv $PWD/../android/app/build/extraJni/arm64-v8a/libwg.so $PWD/nym-vpn-client/src/main/jniLibs/arm64-v8a/


AutoUpdateMode: Version
UpdateCheckMode: Tags nym-vpn-android-v\d+\.\d+\.\d+$
CurrentVersion: nym-vpn-android-v1.1.2
CurrentVersionCode: 11200