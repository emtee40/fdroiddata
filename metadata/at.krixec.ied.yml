Categories:
  - Games
License: MIT
AuthorName: Krixec
AuthorEmail: krixec@yandex.com
SourceCode: https://codeberg.org/Krixec/IED-FDroid
IssueTracker: https://codeberg.org/Krixec/IED-FDroid/issues

AutoName: IED

RepoType: git
Repo: https://codeberg.org/Krixec/IED-FDroid.git

Builds:
  - versionName: Ni havas lingvojn
    versionCode: 12
    commit: 2a290a87d11c1a24fba0f97db4ebcabdc44e3afa
    sudo:
      - apt-get update
      - apt-get install -y clang pkgconf scons
    output: IED.apk
    srclibs:
      - Godot@b09f793f564a6c95dc76acc654b390e68441bd01
    prebuild:
      - mkdir -p android
      - pushd $$Godot$$
      - scons --clean platform=linuxbsd target=editor use_llvm=yes tools=yes
      - scons --clean platform=android arch=arm64v8 production=yes target=template_release
      - scons --clean platform=android arch=armv7 production=yes target=template_release
      - cd platform/android/java
      - ./gradlew cleanGodotTemplates
      - popd
    build:
      - export ANDROID_SDK_ROOT=$$SDK$$
      - export ANDROID_NDK_ROOT=$$NDK$$
      - export GODOT_CFG=~/.config/godot/editor_settings-4.tres
      - export GODOT_TMPL=$$Godot$$/bin/android_release.apk
      - pushd $$Godot$$
      - scons -j `nproc` platform=linuxbsd target=editor use_llvm=yes tools=yes
      - scons -j `nproc` platform=android arch=arm64v8 production=yes target=template_release
      - scons -j `nproc` platform=android arch=armv7 production=yes target=template_release
      - cd platform/android/java
      - ./gradlew generateGodotTemplates
      - popd
      - $$Godot$$/bin/godot.linuxbsd.editor.x86_64.llvm --headless --check-only --quit
        project.godot
      - sed -i -e 's:\(^.*android_sdk_path\)\s*=.*$:\1 = "$$SDK$$":' $GODOT_CFG
      - sed -i -e '/custom_template\/release/s|=.*|="$$Godot$$/bin/android_release.apk"|'
        export_presets.cfg
      - $$Godot$$/bin/godot.linuxbsd.editor.x86_64.llvm --headless --export-release
      - $$Godot$$/bin/godot.linuxbsd.editor.x86_64.llvm --headless --export-release
        'Android' IED.apk
    ndk: 26.2.11394342

AutoUpdateMode: Version
UpdateCheckMode: Tags
UpdateCheckData: export_presets.cfg|version/code=(\d+)|.|version/name="([^"]*)"
CurrentVersionCode: 12
